"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const express = require("express");
const bodyParser = require("body-parser");
const analyzer_1 = require("./analyzer");
const MAX_REQUEST_SIZE = "50mb";
function start(port = 0) {
    return new Promise(resolve => {
        console.log("DEBUG starting eslint-bridge server at port", port);
        const app = express();
        // for parsing application/json requests
        app.use(bodyParser.json({ limit: MAX_REQUEST_SIZE }));
        app.post("/analyze", (request, response) => {
            const parsedRequest = request.body;
            const issues = analyzer_1.analyze(parsedRequest);
            response.json(issues);
        });
        const server = app.listen(port, () => {
            console.log("DEBUG eslint-bridge server is running at port", server.address().port);
            resolve(server);
        });
    });
}
exports.start = start;
//# sourceMappingURL=server.js.map